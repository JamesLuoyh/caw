2022-07-13 10:10:39,336 - root - INFO - Create log file at log/1657732239.33669-reddit-t-2-32k16-16.log
2022-07-13 10:10:39,337 - root - INFO - Command line executed: python main.py -d reddit --pos_dim 16 --bs 100 --n_degree 32 16 --n_hop 2 --mode t --bias 1e-5 --seed 2 --verbosity 1 --drop_out 0.1 --attn_n_head 2 --ngh_dim 4 --self_dim 172 --run 2 --replace_prob 0.3
2022-07-13 10:10:39,337 - root - INFO - Full args parsed:
2022-07-13 10:10:39,337 - root - INFO - Namespace(attn_n_head=2, bias=1e-05, bs=100, cpu_cores=1, data='reddit', drop_out=0.1, gpu=0, linear_out=False, lr=0.0001, mode='t', n_degree=['32', '16'], n_epoch=50, n_hop=2, ngh_dim=4, pos_dim=16, replace_prob=0.3, run=2, seed=2, self_dim=172, t_batch=False, t_batch_order=False, time_dim=1, tolerance=0.001, verbosity=1)
2022-07-13 10:10:39,337 - root - INFO - Create checkpoint directory ./saved_checkpoints/1657732239.33669-reddit-t-2-32k16-16/
2022-07-13 10:10:39,337 - root - INFO - Create best model directory ./best_models/1657732239.33669-reddit-t-2-32k16-16/
2022-07-13 10:10:40,008 - root - INFO - Transductive training...
2022-07-13 10:10:43,394 - root - INFO - num of training instances: 470713
2022-07-13 10:10:43,394 - root - INFO - num of batches per epoch: 4708
2022-07-13 10:10:43,445 - root - INFO - start 0 epoch
2022-07-13 10:13:24,311 - root - INFO - train_time [160.91611504554749]
2022-07-13 10:13:24,311 - root - INFO - Mean 16091.611504554749
2022-07-13 10:13:24,311 - root - INFO - Standard deviation 0.0
2022-07-13 10:13:24,311 - root - INFO - 95% 0.0
2022-07-13 10:13:24,312 - root - INFO - --------
2022-07-13 10:14:24,797 - root - INFO - epoch: 0:
2022-07-13 10:14:24,798 - root - INFO - epoch mean loss: 0.3407247599646348
2022-07-13 10:14:24,799 - root - INFO - train acc: 0.9338222175021239, val acc: 0.9525253726609578
2022-07-13 10:14:24,799 - root - INFO - train auc: 0.978355872982158, val auc: 0.9876212263122424
2022-07-13 10:14:24,800 - root - INFO - train ap: 0.9807689566843117, val ap: 0.9891945244996987
2022-07-13 10:14:24,800 - root - INFO - train time: 160.91611504554749, val time: 60.485806703567505
2022-07-13 10:14:27,364 - root - INFO - start 1 epoch
2022-07-13 10:17:06,352 - root - INFO - train_time [160.91611504554749, 159.04864168167114]
2022-07-13 10:17:06,352 - root - INFO - Mean 15998.237836360931
2022-07-13 10:17:06,352 - root - INFO - Standard deviation 0.9337366819381714
2022-07-13 10:17:06,352 - root - INFO - 95% 129.40930176965705
2022-07-13 10:17:06,352 - root - INFO - --------
2022-07-13 10:18:06,259 - root - INFO - epoch: 1:
2022-07-13 10:18:06,260 - root - INFO - epoch mean loss: 0.3142326470431235
2022-07-13 10:18:06,260 - root - INFO - train acc: 0.9385694562446899, val acc: 0.9538237392959087
2022-07-13 10:18:06,260 - root - INFO - train auc: 0.9815434898045879, val auc: 0.9881675809744688
2022-07-13 10:18:06,261 - root - INFO - train ap: 0.9840223937509331, val ap: 0.9897459544404412
2022-07-13 10:18:06,261 - root - INFO - train time: 159.04864168167114, val time: 59.90631413459778
2022-07-13 10:18:08,721 - root - INFO - start 2 epoch
2022-07-13 10:20:23,761 - root - INFO - train_time [160.91611504554749, 159.04864168167114, 135.09466886520386]
2022-07-13 10:20:23,762 - root - INFO - Mean 15168.647519747416
2022-07-13 10:20:23,762 - root - INFO - Standard deviation 11.756923980272806
2022-07-13 10:20:23,763 - root - INFO - 95% 1330.4211920710843
2022-07-13 10:20:23,763 - root - INFO - --------
2022-07-13 10:21:19,221 - root - INFO - epoch: 2:
2022-07-13 10:21:19,222 - root - INFO - epoch mean loss: 0.34263640835552067
2022-07-13 10:21:19,222 - root - INFO - train acc: 0.9281580996884735, val acc: 0.9356961623850302
2022-07-13 10:21:19,223 - root - INFO - train auc: 0.9796252548853015, val auc: 0.9841865324195211
2022-07-13 10:21:19,223 - root - INFO - train ap: 0.9820031441676946, val ap: 0.9856482687302491
2022-07-13 10:21:19,224 - root - INFO - train time: 135.09466886520386, val time: 55.458369970321655
2022-07-13 10:21:21,813 - root - INFO - start 3 epoch
2022-07-13 10:24:10,852 - root - INFO - train_time [160.91611504554749, 159.04864168167114, 135.09466886520386, 169.09212923049927]
2022-07-13 10:24:10,852 - root - INFO - Mean 15603.788870573044
2022-07-13 10:24:10,852 - root - INFO - Standard deviation 12.667807413595334
2022-07-13 10:24:10,852 - root - INFO - 95% 1241.4451265323428
2022-07-13 10:24:10,852 - root - INFO - --------
2022-07-13 10:25:22,554 - root - INFO - epoch: 3:
2022-07-13 10:25:22,555 - root - INFO - epoch mean loss: 0.35035246370728984
2022-07-13 10:25:22,555 - root - INFO - train acc: 0.9266726847918436, val acc: 0.9420987947986045
2022-07-13 10:25:22,556 - root - INFO - train auc: 0.9787403249787594, val auc: 0.986911027196321
2022-07-13 10:25:22,556 - root - INFO - train ap: 0.9813543256408336, val ap: 0.9878781866587388
2022-07-13 10:25:22,556 - root - INFO - train time: 169.09212923049927, val time: 71.70134735107422
2022-07-13 10:25:22,556 - root - INFO - No improvment over 3 epochs, stop training
2022-07-13 10:25:22,556 - root - INFO - Loading the best model at epoch 0
2022-07-13 10:25:25,061 - root - INFO - Loaded the best model at epoch 0 for inference
2022-07-13 10:26:33,048 - root - INFO - Test statistics: t all nodes -- acc: 0.9532191563590231, auc: 0.9871005788138281, ap: 0.9887511258858511, time: 67.98485922813416
2022-07-13 10:26:33,049 - root - INFO - Saving NAT model ...
2022-07-13 10:26:36,333 - root - INFO - NAT model saved
2022-07-13 10:26:36,339 - root - INFO - transductive_auc [0.9871005788138281]
2022-07-13 10:26:36,339 - root - INFO - Mean 98.71005788138281
2022-07-13 10:26:36,339 - root - INFO - Standard deviation 0.0
2022-07-13 10:26:36,339 - root - INFO - 95% 0.0
2022-07-13 10:26:36,339 - root - INFO - --------
2022-07-13 10:26:36,339 - root - INFO - transductive_ap [0.9887511258858511]
2022-07-13 10:26:36,339 - root - INFO - Mean 98.87511258858511
2022-07-13 10:26:36,340 - root - INFO - Standard deviation 0.0
2022-07-13 10:26:36,340 - root - INFO - 95% 0.0
2022-07-13 10:26:36,340 - root - INFO - --------
2022-07-13 10:26:36,340 - root - INFO - test_times [67.98485922813416]
2022-07-13 10:26:36,340 - root - INFO - Mean 6798.4859228134155
2022-07-13 10:26:36,340 - root - INFO - Standard deviation 0.0
2022-07-13 10:26:36,340 - root - INFO - 95% 0.0
2022-07-13 10:26:36,340 - root - INFO - --------
2022-07-13 10:26:36,340 - root - INFO - early_stoppers [1]
2022-07-13 10:26:36,340 - root - INFO - Mean 100
2022-07-13 10:26:36,340 - root - INFO - Standard deviation 0.0
2022-07-13 10:26:36,340 - root - INFO - 95% 0.0
2022-07-13 10:26:36,340 - root - INFO - --------
2022-07-13 10:26:36,341 - root - INFO - total_time [956.0402314662933]
2022-07-13 10:26:36,341 - root - INFO - Mean 95604.02314662933
2022-07-13 10:26:36,341 - root - INFO - Standard deviation 0.0
2022-07-13 10:26:36,341 - root - INFO - 95% 0.0
2022-07-13 10:26:36,341 - root - INFO - --------
2022-07-13 10:26:36,341 - root - INFO - Transductive training...
2022-07-13 10:26:38,367 - root - INFO - num of training instances: 470713
2022-07-13 10:26:38,368 - root - INFO - num of batches per epoch: 4708
2022-07-13 10:26:38,508 - root - INFO - start 0 epoch
2022-07-13 10:30:07,606 - root - INFO - train_time [209.2367889881134]
2022-07-13 10:30:07,607 - root - INFO - Mean 20923.67889881134
2022-07-13 10:30:07,607 - root - INFO - Standard deviation 0.0
2022-07-13 10:30:07,607 - root - INFO - 95% 0.0
2022-07-13 10:30:07,607 - root - INFO - --------
2022-07-13 10:31:23,942 - root - INFO - epoch: 0:
2022-07-13 10:31:23,944 - root - INFO - epoch mean loss: 0.3473346371206826
2022-07-13 10:31:23,945 - root - INFO - train acc: 0.9326178844519964, val acc: 0.9516581430383761
2022-07-13 10:31:23,947 - root - INFO - train auc: 0.977587914188615, val auc: 0.9871719703952585
2022-07-13 10:31:23,948 - root - INFO - train ap: 0.9799615604628295, val ap: 0.9888608977144648
2022-07-13 10:31:23,948 - root - INFO - train time: 209.2367889881134, val time: 76.33474922180176
2022-07-13 10:31:30,096 - root - INFO - start 1 epoch
2022-07-13 10:34:29,662 - root - INFO - train_time [209.2367889881134, 179.6732792854309]
2022-07-13 10:34:29,662 - root - INFO - Mean 19445.503413677216
2022-07-13 10:34:29,663 - root - INFO - Standard deviation 14.781754851341248
2022-07-13 10:34:29,663 - root - INFO - 95% 2048.6467022712263
2022-07-13 10:34:29,663 - root - INFO - --------
2022-07-13 10:35:45,021 - root - INFO - epoch: 1:
2022-07-13 10:35:45,024 - root - INFO - epoch mean loss: 0.3689966139825933
2022-07-13 10:35:45,025 - root - INFO - train acc: 0.9226419569527048, val acc: 0.9333818981921979
2022-07-13 10:35:45,026 - root - INFO - train auc: 0.9762577315208157, val auc: 0.9857210642641928
2022-07-13 10:35:45,028 - root - INFO - train ap: 0.9793328620327522, val ap: 0.9871493627217977
2022-07-13 10:35:45,028 - root - INFO - train time: 179.6732792854309, val time: 75.35859155654907
2022-07-13 10:35:51,423 - root - INFO - start 2 epoch
2022-07-13 10:39:26,608 - root - INFO - train_time [209.2367889881134, 179.6732792854309, 215.2230429649353]
2022-07-13 10:39:26,609 - root - INFO - Mean 20137.77037461599
2022-07-13 10:39:26,610 - root - INFO - Standard deviation 15.54070654866055
2022-07-13 10:39:26,610 - root - INFO - 95% 1758.596497416165
2022-07-13 10:39:26,611 - root - INFO - --------
2022-07-13 10:40:41,734 - root - INFO - epoch: 2:
2022-07-13 10:40:41,735 - root - INFO - epoch mean loss: 0.29959669478471845
2022-07-13 10:40:41,735 - root - INFO - train acc: 0.9407419994335882, val acc: 0.9558307564224549
2022-07-13 10:40:41,736 - root - INFO - train auc: 0.9829530798640613, val auc: 0.9903423141155249
2022-07-13 10:40:41,736 - root - INFO - train ap: 0.9850378304946086, val ap: 0.9913304762436683
2022-07-13 10:40:41,736 - root - INFO - train time: 215.2230429649353, val time: 75.12329888343811
2022-07-13 10:40:48,417 - root - INFO - start 3 epoch
2022-07-13 10:44:30,842 - root - INFO - train_time [209.2367889881134, 179.6732792854309, 215.2230429649353, 222.51278638839722]
2022-07-13 10:44:30,842 - root - INFO - Mean 20666.14744067192
2022-07-13 10:44:30,843 - root - INFO - Standard deviation 16.275437542623813
2022-07-13 10:44:30,844 - root - INFO - 95% 1594.9928791771335
2022-07-13 10:44:30,844 - root - INFO - --------
2022-07-13 10:45:49,716 - root - INFO - epoch: 3:
2022-07-13 10:45:49,718 - root - INFO - epoch mean loss: 0.2868958730590842
2022-07-13 10:45:49,719 - root - INFO - train acc: 0.9438519541206457, val acc: 0.9557663336504916
2022-07-13 10:45:49,721 - root - INFO - train auc: 0.9847194243840272, val auc: 0.9909143759415636
2022-07-13 10:45:49,722 - root - INFO - train ap: 0.9864496532482643, val ap: 0.9915208852418846
2022-07-13 10:45:49,722 - root - INFO - train time: 222.51278638839722, val time: 78.87187480926514
2022-07-13 10:45:53,874 - root - INFO - start 4 epoch
2022-07-13 10:49:05,228 - root - INFO - train_time [209.2367889881134, 179.6732792854309, 215.2230429649353, 222.51278638839722, 191.45657348632812]
2022-07-13 10:49:05,228 - root - INFO - Mean 20362.0494222641
2022-07-13 10:49:05,228 - root - INFO - Standard deviation 15.77663258375831
2022-07-13 10:49:05,229 - root - INFO - 95% 1382.8828182022116
2022-07-13 10:49:05,229 - root - INFO - --------
2022-07-13 10:50:24,251 - root - INFO - epoch: 4:
2022-07-13 10:50:24,252 - root - INFO - epoch mean loss: 0.3244325142249326
2022-07-13 10:50:24,252 - root - INFO - train acc: 0.9330837581421693, val acc: 0.9468413019346654
2022-07-13 10:50:24,252 - root - INFO - train auc: 0.9817698716133294, val auc: 0.988387175903901
2022-07-13 10:50:24,253 - root - INFO - train ap: 0.9837883474603354, val ap: 0.9893827274463917
2022-07-13 10:50:24,253 - root - INFO - train time: 191.45657348632812, val time: 79.02234053611755
2022-07-13 10:50:28,887 - root - INFO - start 5 epoch
2022-07-13 10:54:13,832 - root - INFO - train_time [209.2367889881134, 179.6732792854309, 215.2230429649353, 222.51278638839722, 191.45657348632812, 224.99327063560486]
2022-07-13 10:54:13,832 - root - INFO - Mean 20718.262362480164
2022-07-13 10:54:13,834 - root - INFO - Standard deviation 16.457894026609452
2022-07-13 10:54:13,835 - root - INFO - 95% 1316.9057917957514
2022-07-13 10:54:13,835 - root - INFO - --------
2022-07-13 10:55:31,666 - root - INFO - epoch: 5:
2022-07-13 10:55:31,668 - root - INFO - epoch mean loss: 0.2841055864609063
2022-07-13 10:55:31,670 - root - INFO - train acc: 0.9437988530161426, val acc: 0.9583333333333334
2022-07-13 10:55:31,672 - root - INFO - train auc: 0.9850937022090059, val auc: 0.9914227893078021
2022-07-13 10:55:31,673 - root - INFO - train ap: 0.9867135338049707, val ap: 0.991955395958802
2022-07-13 10:55:31,673 - root - INFO - train time: 224.99327063560486, val time: 77.83081340789795
2022-07-13 10:55:31,673 - root - INFO - No improvment over 3 epochs, stop training
2022-07-13 10:55:31,674 - root - INFO - Loading the best model at epoch 2
2022-07-13 10:55:34,206 - root - INFO - Loaded the best model at epoch 2 for inference
2022-07-13 10:56:50,857 - root - INFO - Test statistics: t all nodes -- acc: 0.9559100459879479, auc: 0.9898932130609737, ap: 0.9909718978348767, time: 76.64955735206604
2022-07-13 10:56:50,857 - root - INFO - Saving NAT model ...
2022-07-13 10:56:56,739 - root - INFO - NAT model saved
2022-07-13 10:56:56,739 - root - INFO - transductive_auc [0.9871005788138281, 0.9898932130609737]
2022-07-13 10:56:56,739 - root - INFO - Mean 98.84968959374008
2022-07-13 10:56:56,740 - root - INFO - Standard deviation 0.001396317123572799
2022-07-13 10:56:56,740 - root - INFO - 95% 0.19351968012598322
2022-07-13 10:56:56,740 - root - INFO - --------
2022-07-13 10:56:56,740 - root - INFO - transductive_ap [0.9887511258858511, 0.9909718978348767]
2022-07-13 10:56:56,740 - root - INFO - Mean 98.9861511860364
2022-07-13 10:56:56,740 - root - INFO - Standard deviation 0.0011103859745127953
2022-07-13 10:56:56,740 - root - INFO - 95% 0.15389164465323638
2022-07-13 10:56:56,740 - root - INFO - --------
2022-07-13 10:56:56,741 - root - INFO - test_times [67.98485922813416, 76.64955735206604]
2022-07-13 10:56:56,741 - root - INFO - Mean 7231.72082901001
2022-07-13 10:56:56,741 - root - INFO - Standard deviation 4.332349061965942
2022-07-13 10:56:56,741 - root - INFO - 95% 600.4329464359259
2022-07-13 10:56:56,741 - root - INFO - --------
2022-07-13 10:56:56,741 - root - INFO - early_stoppers [1, 3]
2022-07-13 10:56:56,741 - root - INFO - Mean 200
2022-07-13 10:56:56,741 - root - INFO - Standard deviation 1.0
2022-07-13 10:56:56,741 - root - INFO - 95% 138.5929291125633
2022-07-13 10:56:56,741 - root - INFO - --------
2022-07-13 10:56:56,741 - root - INFO - total_time [956.0402314662933, 1819.876872062683]
2022-07-13 10:56:56,741 - root - INFO - Mean 138795.85517644882
2022-07-13 10:56:56,742 - root - INFO - Standard deviation 431.9183202981949
2022-07-13 10:56:56,742 - root - INFO - 95% 59860.82514750514
2022-07-13 10:56:56,742 - root - INFO - --------
