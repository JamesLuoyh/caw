2022-07-12 23:18:56,028 - root - INFO - Create log file at log/1657693136.0286427-reddit-t-2-32k16-16.log
2022-07-12 23:18:56,029 - root - INFO - Command line executed: python main.py -d reddit --pos_dim 16 --bs 100 --n_degree 32 16 --n_hop 2 --mode t --bias 1e-5 --seed 2 --verbosity 1 --drop_out 0.1 --attn_n_head 2 --ngh_dim 4 --self_dim 172 --run 2 --replace_prob 1
2022-07-12 23:18:56,029 - root - INFO - Full args parsed:
2022-07-12 23:18:56,029 - root - INFO - Namespace(attn_n_head=2, bias=1e-05, bs=100, cpu_cores=1, data='reddit', drop_out=0.1, gpu=0, linear_out=False, lr=0.0001, mode='t', n_degree=['32', '16'], n_epoch=50, n_hop=2, ngh_dim=4, pos_dim=16, replace_prob=1.0, run=2, seed=2, self_dim=172, t_batch=False, t_batch_order=False, time_dim=1, tolerance=0.001, verbosity=1)
2022-07-12 23:18:56,029 - root - INFO - Create checkpoint directory ./saved_checkpoints/1657693136.0286427-reddit-t-2-32k16-16/
2022-07-12 23:18:56,029 - root - INFO - Create best model directory ./best_models/1657693136.0286427-reddit-t-2-32k16-16/
2022-07-12 23:19:00,011 - root - INFO - Transductive training...
2022-07-12 23:19:07,447 - root - INFO - num of training instances: 470713
2022-07-12 23:19:07,448 - root - INFO - num of batches per epoch: 4708
2022-07-12 23:19:07,523 - root - INFO - start 0 epoch
2022-07-12 23:23:01,271 - root - INFO - train_time [233.82193088531494]
2022-07-12 23:23:01,272 - root - INFO - Mean 23382.193088531494
2022-07-12 23:23:01,273 - root - INFO - Standard deviation 0.0
2022-07-12 23:23:01,273 - root - INFO - 95% 0.0
2022-07-12 23:23:01,273 - root - INFO - --------
2022-07-12 23:24:29,898 - root - INFO - epoch: 0:
2022-07-12 23:24:29,900 - root - INFO - epoch mean loss: 0.3506810741958793
2022-07-12 23:24:29,900 - root - INFO - train acc: 0.9319466864910791, val acc: 0.954517522993974
2022-07-12 23:24:29,901 - root - INFO - train auc: 0.9771358644859812, val auc: 0.9888150608051856
2022-07-12 23:24:29,901 - root - INFO - train ap: 0.979636645705413, val ap: 0.990079249972365
2022-07-12 23:24:29,901 - root - INFO - train time: 233.82193088531494, val time: 88.62508177757263
2022-07-12 23:24:32,566 - root - INFO - start 1 epoch
2022-07-12 23:28:03,525 - root - INFO - train_time [233.82193088531494, 211.01282453536987]
2022-07-12 23:28:03,526 - root - INFO - Mean 22241.73777103424
2022-07-12 23:28:03,526 - root - INFO - Standard deviation 11.404553174972534
2022-07-12 23:28:03,526 - root - INFO - 95% 1580.5904297394272
2022-07-12 23:28:03,526 - root - INFO - --------
2022-07-12 23:29:57,644 - root - INFO - epoch: 1:
2022-07-12 23:29:57,649 - root - INFO - epoch mean loss: 0.31607716560629634
2022-07-12 23:29:57,652 - root - INFO - train acc: 0.9376348768054376, val acc: 0.9501070409134158
2022-07-12 23:29:57,654 - root - INFO - train auc: 0.9813665038232794, val auc: 0.986808198541072
2022-07-12 23:29:57,656 - root - INFO - train ap: 0.9837559963337011, val ap: 0.9871925060782075
2022-07-12 23:29:57,657 - root - INFO - train time: 211.01282453536987, val time: 114.11803817749023
2022-07-12 23:30:02,790 - root - INFO - start 2 epoch
2022-07-12 23:34:24,547 - root - INFO - train_time [233.82193088531494, 211.01282453536987, 261.8078513145447]
2022-07-12 23:34:24,547 - root - INFO - Mean 23554.75355784098
2022-07-12 23:34:24,548 - root - INFO - Standard deviation 20.77285039086507
2022-07-12 23:34:24,548 - root - INFO - 95% 2350.669309940347
2022-07-12 23:34:24,548 - root - INFO - --------
2022-07-12 23:36:12,402 - root - INFO - epoch: 2:
2022-07-12 23:36:12,405 - root - INFO - epoch mean loss: 0.35727532962044367
2022-07-12 23:36:12,406 - root - INFO - train acc: 0.9240569243840272, val acc: 0.9362363225499524
2022-07-12 23:36:12,407 - root - INFO - train auc: 0.9778664719626167, val auc: 0.9859127839557564
2022-07-12 23:36:12,408 - root - INFO - train ap: 0.9805550256760865, val ap: 0.9873046401061017
2022-07-12 23:36:12,409 - root - INFO - train time: 261.8078513145447, val time: 107.85342073440552
2022-07-12 23:36:16,908 - root - INFO - start 3 epoch
2022-07-12 23:40:31,339 - root - INFO - train_time [233.82193088531494, 211.01282453536987, 261.8078513145447, 254.47648811340332]
2022-07-12 23:40:31,339 - root - INFO - Mean 24027.97737121582
2022-07-12 23:40:31,339 - root - INFO - Standard deviation 19.769059620640892
2022-07-12 23:40:31,340 - root - INFO - 95% 1937.3678428228075
2022-07-12 23:40:31,340 - root - INFO - --------
2022-07-12 23:42:13,881 - root - INFO - epoch: 3:
2022-07-12 23:42:13,882 - root - INFO - epoch mean loss: 0.34342130376287155
2022-07-12 23:42:13,883 - root - INFO - train acc: 0.9275846077598414, val acc: 0.9418411037107517
2022-07-12 23:42:13,883 - root - INFO - train auc: 0.9797703589634664, val auc: 0.9870788980732635
2022-07-12 23:42:13,883 - root - INFO - train ap: 0.9819814414748625, val ap: 0.9882267847473938
2022-07-12 23:42:13,883 - root - INFO - train time: 254.47648811340332, val time: 102.54141855239868
2022-07-12 23:42:13,883 - root - INFO - No improvment over 3 epochs, stop training
2022-07-12 23:42:13,884 - root - INFO - Loading the best model at epoch 0
2022-07-12 23:42:16,115 - root - INFO - Loaded the best model at epoch 0 for inference
2022-07-12 23:43:59,987 - root - INFO - Test statistics: t all nodes -- acc: 0.9547553916904535, auc: 0.9888226490643831, ap: 0.9899594562245487, time: 103.86980128288269
2022-07-12 23:43:59,988 - root - INFO - Saving NAT model ...
2022-07-12 23:44:04,230 - root - INFO - NAT model saved
2022-07-12 23:44:04,244 - root - INFO - transductive_auc [0.9888226490643831]
2022-07-12 23:44:04,244 - root - INFO - Mean 98.88226490643831
2022-07-12 23:44:04,244 - root - INFO - Standard deviation 0.0
2022-07-12 23:44:04,244 - root - INFO - 95% 0.0
2022-07-12 23:44:04,244 - root - INFO - --------
2022-07-12 23:44:04,244 - root - INFO - transductive_ap [0.9899594562245487]
2022-07-12 23:44:04,244 - root - INFO - Mean 98.99594562245487
2022-07-12 23:44:04,244 - root - INFO - Standard deviation 0.0
2022-07-12 23:44:04,245 - root - INFO - 95% 0.0
2022-07-12 23:44:04,245 - root - INFO - --------
2022-07-12 23:44:04,245 - root - INFO - test_times [103.86980128288269]
2022-07-12 23:44:04,245 - root - INFO - Mean 10386.980128288269
2022-07-12 23:44:04,245 - root - INFO - Standard deviation 0.0
2022-07-12 23:44:04,245 - root - INFO - 95% 0.0
2022-07-12 23:44:04,245 - root - INFO - --------
2022-07-12 23:44:04,245 - root - INFO - early_stoppers [1]
2022-07-12 23:44:04,245 - root - INFO - Mean 100
2022-07-12 23:44:04,245 - root - INFO - Standard deviation 0.0
2022-07-12 23:44:04,246 - root - INFO - 95% 0.0
2022-07-12 23:44:04,246 - root - INFO - --------
2022-07-12 23:44:04,246 - root - INFO - total_time [1503.6945714950562]
2022-07-12 23:44:04,246 - root - INFO - Mean 150369.45714950562
2022-07-12 23:44:04,246 - root - INFO - Standard deviation 0.0
2022-07-12 23:44:04,246 - root - INFO - 95% 0.0
2022-07-12 23:44:04,246 - root - INFO - --------
2022-07-12 23:44:04,246 - root - INFO - Transductive training...
2022-07-12 23:44:06,175 - root - INFO - num of training instances: 470713
2022-07-12 23:44:06,176 - root - INFO - num of batches per epoch: 4708
2022-07-12 23:44:06,288 - root - INFO - start 0 epoch
2022-07-12 23:49:00,130 - root - INFO - train_time [293.9531285762787]
2022-07-12 23:49:00,131 - root - INFO - Mean 29395.31285762787
2022-07-12 23:49:00,132 - root - INFO - Standard deviation 0.0
2022-07-12 23:49:00,132 - root - INFO - 95% 0.0
2022-07-12 23:49:00,132 - root - INFO - --------
2022-07-12 23:50:53,701 - root - INFO - epoch: 0:
2022-07-12 23:50:53,703 - root - INFO - epoch mean loss: 0.35182227898933494
2022-07-12 23:50:53,704 - root - INFO - train acc: 0.9309016567544603, val acc: 0.9515094751030765
2022-07-12 23:50:53,705 - root - INFO - train auc: 0.9771067119796091, val auc: 0.9888102600697748
2022-07-12 23:50:53,706 - root - INFO - train ap: 0.9793303162597143, val ap: 0.9899138551959594
2022-07-12 23:50:53,706 - root - INFO - train time: 293.9531285762787, val time: 113.56937408447266
2022-07-12 23:50:58,797 - root - INFO - start 1 epoch
2022-07-12 23:55:23,795 - root - INFO - train_time [293.9531285762787, 265.1358995437622]
2022-07-12 23:55:23,796 - root - INFO - Mean 27954.451406002045
2022-07-12 23:55:23,797 - root - INFO - Standard deviation 14.40861451625824
2022-07-12 23:55:23,797 - root - INFO - 95% 1996.9320902620289
2022-07-12 23:55:23,797 - root - INFO - --------
2022-07-12 23:57:17,819 - root - INFO - epoch: 1:
2022-07-12 23:57:17,821 - root - INFO - epoch mean loss: 0.3866385805294766
2022-07-12 23:57:17,821 - root - INFO - train acc: 0.9172837015009913, val acc: 0.9174149619410086
2022-07-12 23:57:17,822 - root - INFO - train auc: 0.9742805756159728, val auc: 0.9759673636715034
2022-07-12 23:57:17,822 - root - INFO - train ap: 0.9774731314596113, val ap: 0.9794519812762345
2022-07-12 23:57:17,822 - root - INFO - train time: 265.1358995437622, val time: 114.02236199378967
2022-07-12 23:57:22,752 - root - INFO - start 2 epoch
2022-07-13 00:02:28,302 - root - INFO - train_time [293.9531285762787, 265.1358995437622, 305.59581899642944]
2022-07-13 00:02:28,304 - root - INFO - Mean 28822.82823721568
2022-07-13 00:02:28,305 - root - INFO - Standard deviation 17.00650206195103
2022-07-13 00:02:28,305 - root - INFO - 95% 1924.4668745145052
2022-07-13 00:02:28,306 - root - INFO - --------
2022-07-13 00:04:26,361 - root - INFO - epoch: 2:
2022-07-13 00:04:26,363 - root - INFO - epoch mean loss: 0.307356334794645
2022-07-13 00:04:26,363 - root - INFO - train acc: 0.9392905692438404, val acc: 0.9561479146844275
2022-07-13 00:04:26,364 - root - INFO - train auc: 0.9821363423959218, val auc: 0.9904663589240406
2022-07-13 00:04:26,364 - root - INFO - train ap: 0.9844196782090682, val ap: 0.9913510508181591
2022-07-13 00:04:26,364 - root - INFO - train time: 305.59581899642944, val time: 118.05500030517578
2022-07-13 00:04:31,108 - root - INFO - start 3 epoch
2022-07-13 00:09:03,609 - root - INFO - train_time [293.9531285762787, 265.1358995437622, 305.59581899642944, 272.54475688934326]
2022-07-13 00:09:03,609 - root - INFO - Mean 28430.74010014534
2022-07-13 00:09:03,609 - root - INFO - Standard deviation 16.218377429840043
2022-07-13 00:09:03,609 - root - INFO - 95% 1589.4009881243242
2022-07-13 00:09:03,609 - root - INFO - --------
2022-07-13 00:10:29,466 - root - INFO - epoch: 3:
2022-07-13 00:10:29,468 - root - INFO - epoch mean loss: 0.2877400931637155
2022-07-13 00:10:29,469 - root - INFO - train acc: 0.9438009770603228, val acc: 0.9580211306692039
2022-07-13 00:10:29,471 - root - INFO - train auc: 0.9846165994052677, val auc: 0.9908333828893118
2022-07-13 00:10:29,472 - root - INFO - train ap: 0.9862943713990384, val ap: 0.9914800796103472
2022-07-13 00:10:29,472 - root - INFO - train time: 272.54475688934326, val time: 85.85632562637329
2022-07-13 00:10:33,462 - root - INFO - start 4 epoch
2022-07-13 00:13:47,433 - root - INFO - train_time [293.9531285762787, 265.1358995437622, 305.59581899642944, 272.54475688934326, 194.019127368927]
2022-07-13 00:13:47,433 - root - INFO - Mean 26624.974627494812
2022-07-13 00:13:47,433 - root - INFO - Standard deviation 38.919714670743794
2022-07-13 00:13:47,434 - root - INFO - 95% 3411.463404612215
2022-07-13 00:13:47,434 - root - INFO - --------
2022-07-13 00:15:11,286 - root - INFO - epoch: 4:
2022-07-13 00:15:11,288 - root - INFO - epoch mean loss: 0.3328655539990459
2022-07-13 00:15:11,290 - root - INFO - train acc: 0.9307370433305012, val acc: 0.9454339121471614
2022-07-13 00:15:11,291 - root - INFO - train auc: 0.9809288881808742, val auc: 0.9880086921186172
2022-07-13 00:15:11,292 - root - INFO - train ap: 0.9830773236569329, val ap: 0.9890328646045665
2022-07-13 00:15:11,293 - root - INFO - train time: 194.019127368927, val time: 83.85225009918213
2022-07-13 00:15:15,367 - root - INFO - start 5 epoch
2022-07-13 00:19:10,521 - root - INFO - train_time [293.9531285762787, 265.1358995437622, 305.59581899642944, 272.54475688934326, 194.019127368927, 235.20298671722412]
2022-07-13 00:19:10,521 - root - INFO - Mean 26107.528634866077
2022-07-13 00:19:10,521 - root - INFO - Standard deviation 37.36525127290317
2022-07-13 00:19:10,521 - root - INFO - 95% 2989.842791163419
2022-07-13 00:19:10,521 - root - INFO - --------
2022-07-13 00:20:29,563 - root - INFO - epoch: 5:
2022-07-13 00:20:29,564 - root - INFO - epoch mean loss: 0.2878209795967415
2022-07-13 00:20:29,565 - root - INFO - train acc: 0.9435832625318605, val acc: 0.9581103314303837
2022-07-13 00:20:29,565 - root - INFO - train auc: 0.9846695093457944, val auc: 0.9912834131184586
2022-07-13 00:20:29,565 - root - INFO - train ap: 0.9864398214827026, val ap: 0.9918890502112305
2022-07-13 00:20:29,565 - root - INFO - train time: 235.20298671722412, val time: 79.04105973243713
2022-07-13 00:20:29,565 - root - INFO - No improvment over 3 epochs, stop training
2022-07-13 00:20:29,566 - root - INFO - Loading the best model at epoch 2
2022-07-13 00:20:31,446 - root - INFO - Loaded the best model at epoch 2 for inference
2022-07-13 00:21:31,097 - root - INFO - Test statistics: t all nodes -- acc: 0.955236084681256, auc: 0.9902857893276245, ap: 0.9911935351008682, time: 59.648956298828125
2022-07-13 00:21:31,097 - root - INFO - Saving NAT model ...
2022-07-13 00:21:35,019 - root - INFO - NAT model saved
2022-07-13 00:21:35,020 - root - INFO - transductive_auc [0.9888226490643831, 0.9902857893276245]
2022-07-13 00:21:35,020 - root - INFO - Mean 98.95542191960038
2022-07-13 00:21:35,021 - root - INFO - Standard deviation 0.0007315701316206735
2022-07-13 00:21:35,022 - root - INFO - 95% 0.10139044739257261
2022-07-13 00:21:35,022 - root - INFO - --------
2022-07-13 00:21:35,022 - root - INFO - transductive_ap [0.9899594562245487, 0.9911935351008682]
2022-07-13 00:21:35,022 - root - INFO - Mean 99.05764956627084
2022-07-13 00:21:35,023 - root - INFO - Standard deviation 0.0006170394381597166
2022-07-13 00:21:35,023 - root - INFO - 95% 0.08551730311252549
2022-07-13 00:21:35,023 - root - INFO - --------
2022-07-13 00:21:35,024 - root - INFO - test_times [103.86980128288269, 59.648956298828125]
2022-07-13 00:21:35,024 - root - INFO - Mean 8175.937879085541
2022-07-13 00:21:35,024 - root - INFO - Standard deviation 22.110422492027283
2022-07-13 00:21:35,025 - root - INFO - 95% 3064.3482170863626
2022-07-13 00:21:35,025 - root - INFO - --------
2022-07-13 00:21:35,025 - root - INFO - early_stoppers [1, 3]
2022-07-13 00:21:35,026 - root - INFO - Mean 200
2022-07-13 00:21:35,026 - root - INFO - Standard deviation 1.0
2022-07-13 00:21:35,026 - root - INFO - 95% 138.5929291125633
2022-07-13 00:21:35,027 - root - INFO - --------
2022-07-13 00:21:35,027 - root - INFO - total_time [1503.6945714950562, 2250.4387152194977]
2022-07-13 00:21:35,027 - root - INFO - Mean 187706.6643357277
2022-07-13 00:21:35,027 - root - INFO - Standard deviation 373.37207186222076
2022-07-13 00:21:35,028 - root - INFO - 95% 51746.72908821166
2022-07-13 00:21:35,028 - root - INFO - --------
