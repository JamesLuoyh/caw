2022-07-13 10:10:49,100 - root - INFO - Create log file at log/1657732249.1004148-reddit-t-2-32k16-16.log
2022-07-13 10:10:49,100 - root - INFO - Command line executed: python main.py -d reddit --pos_dim 16 --bs 100 --n_degree 32 16 --n_hop 2 --mode t --bias 1e-5 --seed 2 --verbosity 1 --drop_out 0.1 --attn_n_head 2 --ngh_dim 4 --self_dim 172 --run 2 --replace_prob 0.1
2022-07-13 10:10:49,100 - root - INFO - Full args parsed:
2022-07-13 10:10:49,100 - root - INFO - Namespace(attn_n_head=2, bias=1e-05, bs=100, cpu_cores=1, data='reddit', drop_out=0.1, gpu=0, linear_out=False, lr=0.0001, mode='t', n_degree=['32', '16'], n_epoch=50, n_hop=2, ngh_dim=4, pos_dim=16, replace_prob=0.1, run=2, seed=2, self_dim=172, t_batch=False, t_batch_order=False, time_dim=1, tolerance=0.001, verbosity=1)
2022-07-13 10:10:49,101 - root - INFO - Create checkpoint directory ./saved_checkpoints/1657732249.1004148-reddit-t-2-32k16-16/
2022-07-13 10:10:49,101 - root - INFO - Create best model directory ./best_models/1657732249.1004148-reddit-t-2-32k16-16/
2022-07-13 10:10:49,654 - root - INFO - Transductive training...
2022-07-13 10:10:53,329 - root - INFO - num of training instances: 470713
2022-07-13 10:10:53,329 - root - INFO - num of batches per epoch: 4708
2022-07-13 10:10:53,378 - root - INFO - start 0 epoch
2022-07-13 10:13:37,675 - root - INFO - train_time [164.3461287021637]
2022-07-13 10:13:37,676 - root - INFO - Mean 16434.61287021637
2022-07-13 10:13:37,676 - root - INFO - Standard deviation 0.0
2022-07-13 10:13:37,676 - root - INFO - 95% 0.0
2022-07-13 10:13:37,676 - root - INFO - --------
2022-07-13 10:14:36,937 - root - INFO - epoch: 0:
2022-07-13 10:14:36,938 - root - INFO - epoch mean loss: 0.34336106745825296
2022-07-13 10:14:36,938 - root - INFO - train acc: 0.9334887425658454, val acc: 0.9517374326038693
2022-07-13 10:14:36,939 - root - INFO - train auc: 0.9781179163126593, val auc: 0.9868795901225024
2022-07-13 10:14:36,939 - root - INFO - train ap: 0.9807402111153899, val ap: 0.9888601270368929
2022-07-13 10:14:36,939 - root - INFO - train time: 164.3461287021637, val time: 59.26085567474365
2022-07-13 10:14:39,500 - root - INFO - start 1 epoch
2022-07-13 10:17:18,717 - root - INFO - train_time [164.3461287021637, 159.25992155075073]
2022-07-13 10:17:18,717 - root - INFO - Mean 16180.302512645721
2022-07-13 10:17:18,718 - root - INFO - Standard deviation 2.543103575706482
2022-07-13 10:17:18,718 - root - INFO - 95% 352.45617359379474
2022-07-13 10:17:18,718 - root - INFO - --------
2022-07-13 10:18:17,453 - root - INFO - epoch: 1:
2022-07-13 10:18:17,454 - root - INFO - epoch mean loss: 0.31443771379924645
2022-07-13 10:18:17,454 - root - INFO - train acc: 0.9387043330501275, val acc: 0.9431295591500158
2022-07-13 10:18:17,455 - root - INFO - train auc: 0.9814840378079864, val auc: 0.9860979994251506
2022-07-13 10:18:17,455 - root - INFO - train ap: 0.983992509760699, val ap: 0.9867702545245877
2022-07-13 10:18:17,455 - root - INFO - train time: 159.25992155075073, val time: 58.734559059143066
2022-07-13 10:18:19,726 - root - INFO - start 2 epoch
2022-07-13 10:20:33,024 - root - INFO - train_time [164.3461287021637, 159.25992155075073, 133.3366289138794]
2022-07-13 10:20:33,024 - root - INFO - Mean 15231.422638893127
2022-07-13 10:20:33,024 - root - INFO - Standard deviation 13.578887540113948
2022-07-13 10:20:33,024 - root - INFO - 95% 1536.595777809767
2022-07-13 10:20:33,024 - root - INFO - --------
2022-07-13 10:21:28,324 - root - INFO - epoch: 2:
2022-07-13 10:21:28,325 - root - INFO - epoch mean loss: 0.34953907054604466
2022-07-13 10:21:28,325 - root - INFO - train acc: 0.9259664401019541, val acc: 0.9398142641928322
2022-07-13 10:21:28,326 - root - INFO - train auc: 0.9789639231096006, val auc: 0.9867171394307009
2022-07-13 10:21:28,326 - root - INFO - train ap: 0.9814287491261565, val ap: 0.9878744829363602
2022-07-13 10:21:28,326 - root - INFO - train time: 133.3366289138794, val time: 55.29948353767395
2022-07-13 10:21:30,802 - root - INFO - start 3 epoch
2022-07-13 10:24:21,067 - root - INFO - train_time [164.3461287021637, 159.25992155075073, 133.3366289138794, 170.3042061328888]
2022-07-13 10:24:21,067 - root - INFO - Mean 15681.172132492065
2022-07-13 10:24:21,067 - root - INFO - Standard deviation 14.105744298619861
2022-07-13 10:24:21,068 - root - INFO - 95% 1382.3629412647463
2022-07-13 10:24:21,068 - root - INFO - --------
2022-07-13 10:25:32,352 - root - INFO - epoch: 3:
2022-07-13 10:25:32,353 - root - INFO - epoch mean loss: 0.3322283440311467
2022-07-13 10:25:32,353 - root - INFO - train acc: 0.9314539082412914, val acc: 0.9443833254043768
2022-07-13 10:25:32,354 - root - INFO - train auc: 0.9809762531860663, val auc: 0.9874309003825722
2022-07-13 10:25:32,354 - root - INFO - train ap: 0.9831034986687367, val ap: 0.9885868607606911
2022-07-13 10:25:32,354 - root - INFO - train time: 170.3042061328888, val time: 71.28425240516663
2022-07-13 10:25:32,354 - root - INFO - No improvment over 3 epochs, stop training
2022-07-13 10:25:32,354 - root - INFO - Loading the best model at epoch 0
2022-07-13 10:25:35,016 - root - INFO - Loaded the best model at epoch 0 for inference
2022-07-13 10:26:44,136 - root - INFO - Test statistics: t all nodes -- acc: 0.9537394941325722, auc: 0.9867022726371709, ap: 0.9886472066091753, time: 69.11951088905334
2022-07-13 10:26:44,136 - root - INFO - Saving NAT model ...
2022-07-13 10:26:47,464 - root - INFO - NAT model saved
2022-07-13 10:26:47,467 - root - INFO - transductive_auc [0.9867022726371709]
2022-07-13 10:26:47,467 - root - INFO - Mean 98.6702272637171
2022-07-13 10:26:47,467 - root - INFO - Standard deviation 0.0
2022-07-13 10:26:47,467 - root - INFO - 95% 0.0
2022-07-13 10:26:47,467 - root - INFO - --------
2022-07-13 10:26:47,467 - root - INFO - transductive_ap [0.9886472066091753]
2022-07-13 10:26:47,467 - root - INFO - Mean 98.86472066091753
2022-07-13 10:26:47,467 - root - INFO - Standard deviation 0.0
2022-07-13 10:26:47,467 - root - INFO - 95% 0.0
2022-07-13 10:26:47,467 - root - INFO - --------
2022-07-13 10:26:47,468 - root - INFO - test_times [69.11951088905334]
2022-07-13 10:26:47,468 - root - INFO - Mean 6911.9510889053345
2022-07-13 10:26:47,468 - root - INFO - Standard deviation 0.0
2022-07-13 10:26:47,468 - root - INFO - 95% 0.0
2022-07-13 10:26:47,468 - root - INFO - --------
2022-07-13 10:26:47,468 - root - INFO - early_stoppers [1]
2022-07-13 10:26:47,468 - root - INFO - Mean 100
2022-07-13 10:26:47,468 - root - INFO - Standard deviation 0.0
2022-07-13 10:26:47,468 - root - INFO - 95% 0.0
2022-07-13 10:26:47,468 - root - INFO - --------
2022-07-13 10:26:47,468 - root - INFO - total_time [957.4958703517914]
2022-07-13 10:26:47,468 - root - INFO - Mean 95749.58703517914
2022-07-13 10:26:47,468 - root - INFO - Standard deviation 0.0
2022-07-13 10:26:47,469 - root - INFO - 95% 0.0
2022-07-13 10:26:47,469 - root - INFO - --------
2022-07-13 10:26:47,469 - root - INFO - Transductive training...
2022-07-13 10:26:48,788 - root - INFO - num of training instances: 470713
2022-07-13 10:26:48,788 - root - INFO - num of batches per epoch: 4708
2022-07-13 10:26:48,838 - root - INFO - start 0 epoch
2022-07-13 10:30:16,658 - root - INFO - train_time [207.86872339248657]
2022-07-13 10:30:16,658 - root - INFO - Mean 20786.872339248657
2022-07-13 10:30:16,658 - root - INFO - Standard deviation 0.0
2022-07-13 10:30:16,658 - root - INFO - 95% 0.0
2022-07-13 10:30:16,658 - root - INFO - --------
2022-07-13 10:31:30,872 - root - INFO - epoch: 0:
2022-07-13 10:31:30,874 - root - INFO - epoch mean loss: 0.3432761641708262
2022-07-13 10:31:30,875 - root - INFO - train acc: 0.9334175870858114, val acc: 0.9518167221693625
2022-07-13 10:31:30,877 - root - INFO - train auc: 0.9780598874256584, val auc: 0.9879495346693625
2022-07-13 10:31:30,878 - root - INFO - train ap: 0.9804417278437687, val ap: 0.9894747617396126
2022-07-13 10:31:30,878 - root - INFO - train time: 207.86872339248657, val time: 74.21390056610107
2022-07-13 10:31:36,924 - root - INFO - start 1 epoch
2022-07-13 10:34:35,785 - root - INFO - train_time [207.86872339248657, 178.9982373714447]
2022-07-13 10:34:35,785 - root - INFO - Mean 19343.348038196564
2022-07-13 10:34:35,786 - root - INFO - Standard deviation 14.435243010520935
2022-07-13 10:34:35,786 - root - INFO - 95% 2000.6226112797528
2022-07-13 10:34:35,786 - root - INFO - --------
2022-07-13 10:35:49,826 - root - INFO - epoch: 1:
2022-07-13 10:35:49,827 - root - INFO - epoch mean loss: 0.36972555835607096
2022-07-13 10:35:49,827 - root - INFO - train acc: 0.9228118804871142, val acc: 0.9404436251189343
2022-07-13 10:35:49,828 - root - INFO - train auc: 0.9763079864061174, val auc: 0.9861192155784174
2022-07-13 10:35:49,828 - root - INFO - train ap: 0.9792376090503967, val ap: 0.9874297009071896
2022-07-13 10:35:49,828 - root - INFO - train time: 178.9982373714447, val time: 74.04000616073608
2022-07-13 10:35:56,608 - root - INFO - start 2 epoch
2022-07-13 10:39:31,383 - root - INFO - train_time [207.86872339248657, 178.9982373714447, 214.8924105167389]
2022-07-13 10:39:31,383 - root - INFO - Mean 20058.645709355675
2022-07-13 10:39:31,383 - root - INFO - Standard deviation 15.532148773484558
2022-07-13 10:39:31,383 - root - INFO - 95% 1757.6280939910666
2022-07-13 10:39:31,383 - root - INFO - --------
2022-07-13 10:40:46,282 - root - INFO - epoch: 2:
2022-07-13 10:40:46,283 - root - INFO - epoch mean loss: 0.29340854452126924
2022-07-13 10:40:46,283 - root - INFO - train acc: 0.9418967714528462, val acc: 0.95659887408817
2022-07-13 10:40:46,284 - root - INFO - train auc: 0.9838112574341547, val auc: 0.991092467739058
2022-07-13 10:40:46,284 - root - INFO - train ap: 0.985684433003855, val ap: 0.991991862630334
2022-07-13 10:40:46,284 - root - INFO - train time: 214.8924105167389, val time: 74.89900755882263
2022-07-13 10:40:53,123 - root - INFO - start 3 epoch
2022-07-13 10:44:35,136 - root - INFO - train_time [207.86872339248657, 178.9982373714447, 214.8924105167389, 222.06221079826355]
2022-07-13 10:44:35,137 - root - INFO - Mean 20595.539551973343
2022-07-13 10:44:35,137 - root - INFO - Standard deviation 16.35274391695393
2022-07-13 10:44:35,137 - root - INFO - 95% 1602.568903861485
2022-07-13 10:44:35,137 - root - INFO - --------
2022-07-13 10:45:53,238 - root - INFO - epoch: 3:
2022-07-13 10:45:53,279 - root - INFO - epoch mean loss: 0.2876666401407682
2022-07-13 10:45:53,280 - root - INFO - train acc: 0.9431347352024922, val acc: 0.9575354820805582
2022-07-13 10:45:53,282 - root - INFO - train auc: 0.984761214953271, val auc: 0.9910167400095148
2022-07-13 10:45:53,283 - root - INFO - train ap: 0.9865110479981134, val ap: 0.991686555749653
2022-07-13 10:45:53,283 - root - INFO - train time: 222.06221079826355, val time: 78.10069513320923
2022-07-13 10:45:57,531 - root - INFO - start 4 epoch
2022-07-13 10:49:06,477 - root - INFO - train_time [207.86872339248657, 178.9982373714447, 214.8924105167389, 222.06221079826355, 188.99406671524048]
2022-07-13 10:49:06,477 - root - INFO - Mean 20256.312975883484
2022-07-13 10:49:06,477 - root - INFO - Standard deviation 16.1232643984101
2022-07-13 10:49:06,477 - root - INFO - 95% 1413.2664363906517
2022-07-13 10:49:06,477 - root - INFO - --------
2022-07-13 10:50:23,669 - root - INFO - epoch: 4:
2022-07-13 10:50:23,671 - root - INFO - epoch mean loss: 0.3307938173084109
2022-07-13 10:50:23,673 - root - INFO - train acc: 0.9315247097139622, val acc: 0.9477630431335237
2022-07-13 10:50:23,674 - root - INFO - train auc: 0.9811940739167374, val auc: 0.988714400223993
2022-07-13 10:50:23,675 - root - INFO - train ap: 0.9833155178162957, val ap: 0.9896187860058291
2022-07-13 10:50:23,675 - root - INFO - train time: 188.99406671524048, val time: 77.1917552947998
2022-07-13 10:50:27,833 - root - INFO - start 5 epoch
2022-07-13 10:54:11,623 - root - INFO - train_time [207.86872339248657, 178.9982373714447, 214.8924105167389, 222.06221079826355, 188.99406671524048, 223.83896470069885]
2022-07-13 10:54:11,623 - root - INFO - Mean 20610.91022491455
2022-07-13 10:54:11,623 - root - INFO - Standard deviation 16.71833275861359
2022-07-13 10:54:11,624 - root - INFO - 95% 1337.7452305495597
2022-07-13 10:54:11,624 - root - INFO - --------
2022-07-13 10:55:28,078 - root - INFO - epoch: 5:
2022-07-13 10:55:28,080 - root - INFO - epoch mean loss: 0.2838444607743808
2022-07-13 10:55:28,081 - root - INFO - train acc: 0.9441117955253469, val acc: 0.9593046305106248
2022-07-13 10:55:28,082 - root - INFO - train auc: 0.9851292162276974, val auc: 0.9914556201435141
2022-07-13 10:55:28,084 - root - INFO - train ap: 0.9868008346485257, val ap: 0.9920499816588414
2022-07-13 10:55:28,084 - root - INFO - train time: 223.83896470069885, val time: 76.45364117622375
2022-07-13 10:55:28,084 - root - INFO - No improvment over 3 epochs, stop training
2022-07-13 10:55:28,084 - root - INFO - Loading the best model at epoch 2
2022-07-13 10:55:30,434 - root - INFO - Loaded the best model at epoch 2 for inference
2022-07-13 10:56:46,772 - root - INFO - Test statistics: t all nodes -- acc: 0.9518514113542658, auc: 0.9910266512052014, ap: 0.9919880663509458, time: 76.33605575561523
2022-07-13 10:56:46,773 - root - INFO - Saving NAT model ...
2022-07-13 10:56:53,805 - root - INFO - NAT model saved
2022-07-13 10:56:53,805 - root - INFO - transductive_auc [0.9867022726371709, 0.9910266512052014]
2022-07-13 10:56:53,805 - root - INFO - Mean 98.88644619211861
2022-07-13 10:56:53,806 - root - INFO - Standard deviation 0.002162189284015237
2022-07-13 10:56:53,806 - root - INFO - 95% 0.2996641461674677
2022-07-13 10:56:53,806 - root - INFO - --------
2022-07-13 10:56:53,806 - root - INFO - transductive_ap [0.9886472066091753, 0.9919880663509458]
2022-07-13 10:56:53,806 - root - INFO - Mean 99.03176364800605
2022-07-13 10:56:53,806 - root - INFO - Standard deviation 0.0016704298708852816
2022-07-13 10:56:53,806 - root - INFO - 95% 0.2315097686831121
2022-07-13 10:56:53,806 - root - INFO - --------
2022-07-13 10:56:53,806 - root - INFO - test_times [69.11951088905334, 76.33605575561523]
2022-07-13 10:56:53,807 - root - INFO - Mean 7272.778332233429
2022-07-13 10:56:53,807 - root - INFO - Standard deviation 3.608272433280945
2022-07-13 10:56:53,807 - root - INFO - 95% 500.0810455645223
2022-07-13 10:56:53,807 - root - INFO - --------
2022-07-13 10:56:53,807 - root - INFO - early_stoppers [1, 3]
2022-07-13 10:56:53,807 - root - INFO - Mean 200
2022-07-13 10:56:53,807 - root - INFO - Standard deviation 1.0
2022-07-13 10:56:53,807 - root - INFO - 95% 138.5929291125633
2022-07-13 10:56:53,807 - root - INFO - --------
2022-07-13 10:56:53,807 - root - INFO - total_time [957.4958703517914, 1806.0355615615845]
2022-07-13 10:56:53,808 - root - INFO - Mean 138176.5715956688
2022-07-13 10:56:53,808 - root - INFO - Standard deviation 424.26984560489655
2022-07-13 10:56:53,808 - root - INFO - 95% 58800.800636517604
2022-07-13 10:56:53,808 - root - INFO - --------
