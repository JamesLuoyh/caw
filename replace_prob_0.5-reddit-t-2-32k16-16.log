2022-07-12 23:17:48,011 - root - INFO - Create log file at log/1657693068.0112998-reddit-t-2-32k16-16.log
2022-07-12 23:17:48,011 - root - INFO - Command line executed: python main.py -d reddit --pos_dim 16 --bs 100 --n_degree 32 16 --n_hop 2 --mode t --bias 1e-5 --seed 2 --verbosity 1 --drop_out 0.1 --attn_n_head 2 --ngh_dim 4 --self_dim 172 --run 2 --replace_prob 0.5
2022-07-12 23:17:48,011 - root - INFO - Full args parsed:
2022-07-12 23:17:48,011 - root - INFO - Namespace(attn_n_head=2, bias=1e-05, bs=100, cpu_cores=1, data='reddit', drop_out=0.1, gpu=0, linear_out=False, lr=0.0001, mode='t', n_degree=['32', '16'], n_epoch=50, n_hop=2, ngh_dim=4, pos_dim=16, replace_prob=0.5, run=2, seed=2, self_dim=172, t_batch=False, t_batch_order=False, time_dim=1, tolerance=0.001, verbosity=1)
2022-07-12 23:17:48,012 - root - INFO - Create checkpoint directory ./saved_checkpoints/1657693068.0112998-reddit-t-2-32k16-16/
2022-07-12 23:17:48,012 - root - INFO - Create best model directory ./best_models/1657693068.0112998-reddit-t-2-32k16-16/
2022-07-12 23:17:49,100 - root - INFO - Transductive training...
2022-07-12 23:17:53,112 - root - INFO - num of training instances: 470713
2022-07-12 23:17:53,113 - root - INFO - num of batches per epoch: 4708
2022-07-12 23:17:53,162 - root - INFO - start 0 epoch
2022-07-12 23:22:04,075 - root - INFO - train_time [250.9614691734314]
2022-07-12 23:22:04,076 - root - INFO - Mean 25096.14691734314
2022-07-12 23:22:04,076 - root - INFO - Standard deviation 0.0
2022-07-12 23:22:04,076 - root - INFO - 95% 0.0
2022-07-12 23:22:04,076 - root - INFO - --------
2022-07-12 23:23:26,244 - root - INFO - epoch: 0:
2022-07-12 23:23:26,245 - root - INFO - epoch mean loss: 0.34608566557502685
2022-07-12 23:23:26,245 - root - INFO - train acc: 0.9327686915887852, val acc: 0.9521289248334919
2022-07-12 23:23:26,246 - root - INFO - train auc: 0.9777286639762108, val auc: 0.9886908611342372
2022-07-12 23:23:26,246 - root - INFO - train ap: 0.9802384404675333, val ap: 0.990083997921111
2022-07-12 23:23:26,246 - root - INFO - train time: 250.9614691734314, val time: 82.16772079467773
2022-07-12 23:23:28,892 - root - INFO - start 1 epoch
2022-07-12 23:27:10,551 - root - INFO - train_time [250.9614691734314, 221.72213172912598]
2022-07-12 23:27:10,552 - root - INFO - Mean 23634.18004512787
2022-07-12 23:27:10,552 - root - INFO - Standard deviation 14.61966872215271
2022-07-12 23:27:10,552 - root - INFO - 95% 2026.1827108584696
2022-07-12 23:27:10,552 - root - INFO - --------
2022-07-12 23:28:34,865 - root - INFO - epoch: 1:
2022-07-12 23:28:34,866 - root - INFO - epoch mean loss: 0.31392949060896946
2022-07-12 23:28:34,866 - root - INFO - train acc: 0.9384972387425657, val acc: 0.9505827783063748
2022-07-12 23:28:34,866 - root - INFO - train auc: 0.9815673003398471, val auc: 0.9862644765401998
2022-07-12 23:28:34,867 - root - INFO - train ap: 0.9840465784617618, val ap: 0.9879886300351999
2022-07-12 23:28:34,867 - root - INFO - train time: 221.72213172912598, val time: 84.31243324279785
2022-07-12 23:28:38,952 - root - INFO - start 2 epoch
2022-07-12 23:33:16,649 - root - INFO - train_time [250.9614691734314, 221.72213172912598, 277.7335431575775]
2022-07-12 23:33:16,650 - root - INFO - Mean 25013.904802004494
2022-07-12 23:33:16,651 - root - INFO - Standard deviation 22.873956587743642
2022-07-12 23:33:16,651 - root - INFO - 95% 2588.4318586996587
2022-07-12 23:33:16,651 - root - INFO - --------
2022-07-12 23:35:03,346 - root - INFO - epoch: 2:
2022-07-12 23:35:03,347 - root - INFO - epoch mean loss: 0.3498426080383076
2022-07-12 23:35:03,347 - root - INFO - train acc: 0.9256988105352593, val acc: 0.9371679749444973
2022-07-12 23:35:03,348 - root - INFO - train auc: 0.97890247451147, val auc: 0.9855671310061845
2022-07-12 23:35:03,348 - root - INFO - train ap: 0.9812729060526398, val ap: 0.9866994357503727
2022-07-12 23:35:03,348 - root - INFO - train time: 277.7335431575775, val time: 106.69503879547119
2022-07-12 23:35:07,654 - root - INFO - start 3 epoch
2022-07-12 23:39:29,487 - root - INFO - train_time [250.9614691734314, 221.72213172912598, 277.7335431575775, 261.8846688270569]
2022-07-12 23:39:29,488 - root - INFO - Mean 25307.545322179794
2022-07-12 23:39:29,489 - root - INFO - Standard deviation 20.45191541176844
2022-07-12 23:39:29,489 - root - INFO - 95% 2004.2877103533071
2022-07-12 23:39:29,489 - root - INFO - --------
2022-07-12 23:41:13,237 - root - INFO - epoch: 3:
2022-07-12 23:41:13,238 - root - INFO - epoch mean loss: 0.3379006268853795
2022-07-12 23:41:13,238 - root - INFO - train acc: 0.929556074766355, val acc: 0.9433723834443387
2022-07-12 23:41:13,239 - root - INFO - train auc: 0.9802122132540355, val auc: 0.9873972952346971
2022-07-12 23:41:13,239 - root - INFO - train ap: 0.9824437299600319, val ap: 0.9885862292426677
2022-07-12 23:41:13,239 - root - INFO - train time: 261.8846688270569, val time: 103.74800229072571
2022-07-12 23:41:13,239 - root - INFO - No improvment over 3 epochs, stop training
2022-07-12 23:41:13,239 - root - INFO - Loading the best model at epoch 0
2022-07-12 23:41:15,829 - root - INFO - Loaded the best model at epoch 0 for inference
2022-07-12 23:42:53,978 - root - INFO - Test statistics: t all nodes -- acc: 0.9536106485886457, auc: 0.9888447943922455, ap: 0.990130735218305, time: 98.14612698554993
2022-07-12 23:42:53,980 - root - INFO - Saving NAT model ...
2022-07-12 23:42:57,765 - root - INFO - NAT model saved
2022-07-12 23:42:57,915 - root - INFO - transductive_auc [0.9888447943922455]
2022-07-12 23:42:57,916 - root - INFO - Mean 98.88447943922455
2022-07-12 23:42:57,917 - root - INFO - Standard deviation 0.0
2022-07-12 23:42:57,918 - root - INFO - 95% 0.0
2022-07-12 23:42:57,918 - root - INFO - --------
2022-07-12 23:42:57,918 - root - INFO - transductive_ap [0.990130735218305]
2022-07-12 23:42:57,919 - root - INFO - Mean 99.01307352183049
2022-07-12 23:42:57,920 - root - INFO - Standard deviation 0.0
2022-07-12 23:42:57,920 - root - INFO - 95% 0.0
2022-07-12 23:42:57,921 - root - INFO - --------
2022-07-12 23:42:57,921 - root - INFO - test_times [98.14612698554993]
2022-07-12 23:42:57,922 - root - INFO - Mean 9814.612698554993
2022-07-12 23:42:57,938 - root - INFO - Standard deviation 0.0
2022-07-12 23:42:57,939 - root - INFO - 95% 0.0
2022-07-12 23:42:57,940 - root - INFO - --------
2022-07-12 23:42:57,940 - root - INFO - early_stoppers [1]
2022-07-12 23:42:57,940 - root - INFO - Mean 100
2022-07-12 23:42:57,941 - root - INFO - Standard deviation 0.0
2022-07-12 23:42:57,941 - root - INFO - 95% 0.0
2022-07-12 23:42:57,941 - root - INFO - --------
2022-07-12 23:42:57,942 - root - INFO - total_time [1508.503723859787]
2022-07-12 23:42:57,942 - root - INFO - Mean 150850.3723859787
2022-07-12 23:42:57,942 - root - INFO - Standard deviation 0.0
2022-07-12 23:42:57,943 - root - INFO - 95% 0.0
2022-07-12 23:42:57,943 - root - INFO - --------
2022-07-12 23:42:57,943 - root - INFO - Transductive training...
2022-07-12 23:43:01,462 - root - INFO - num of training instances: 470713
2022-07-12 23:43:01,482 - root - INFO - num of batches per epoch: 4708
2022-07-12 23:43:01,559 - root - INFO - start 0 epoch
2022-07-12 23:47:56,058 - root - INFO - train_time [294.57536578178406]
2022-07-12 23:47:56,059 - root - INFO - Mean 29457.536578178406
2022-07-12 23:47:56,060 - root - INFO - Standard deviation 0.0
2022-07-12 23:47:56,060 - root - INFO - 95% 0.0
2022-07-12 23:47:56,061 - root - INFO - --------
2022-07-12 23:49:46,259 - root - INFO - epoch: 0:
2022-07-12 23:49:46,261 - root - INFO - epoch mean loss: 0.34691770787896015
2022-07-12 23:49:46,262 - root - INFO - train acc: 0.9323449447748512, val acc: 0.9529515540754837
2022-07-12 23:49:46,264 - root - INFO - train auc: 0.9776412807986407, val auc: 0.9889655870896765
2022-07-12 23:49:46,265 - root - INFO - train ap: 0.9799572591910064, val ap: 0.9900727350930497
2022-07-12 23:49:46,265 - root - INFO - train time: 294.57536578178406, val time: 110.19757795333862
2022-07-12 23:49:51,672 - root - INFO - start 1 epoch
2022-07-12 23:54:15,964 - root - INFO - train_time [294.57536578178406, 264.43358302116394]
2022-07-12 23:54:15,965 - root - INFO - Mean 27950.4474401474
2022-07-12 23:54:15,965 - root - INFO - Standard deviation 15.070891380310059
2022-07-12 23:54:15,966 - root - INFO - 95% 2088.7189807344535
2022-07-12 23:54:15,966 - root - INFO - --------
2022-07-12 23:56:05,281 - root - INFO - epoch: 1:
2022-07-12 23:56:05,282 - root - INFO - epoch mean loss: 0.37851365908391665
2022-07-12 23:56:05,282 - root - INFO - train acc: 0.919951146983857, val acc: 0.9390114573422138
2022-07-12 23:56:05,283 - root - INFO - train auc: 0.9752963891248939, val auc: 0.9854740586841897
2022-07-12 23:56:05,283 - root - INFO - train ap: 0.9784088523787453, val ap: 0.9869098634380042
2022-07-12 23:56:05,283 - root - INFO - train time: 264.43358302116394, val time: 109.31560397148132
2022-07-12 23:56:10,296 - root - INFO - start 2 epoch
2022-07-13 00:01:17,477 - root - INFO - train_time [294.57536578178406, 264.43358302116394, 307.3138177394867]
2022-07-13 00:01:17,478 - root - INFO - Mean 28877.42555141449
2022-07-13 00:01:17,478 - root - INFO - Standard deviation 17.979957223300882
2022-07-13 00:01:17,478 - root - INFO - 95% 2034.6236960065814
2022-07-13 00:01:17,478 - root - INFO - --------
2022-07-13 00:03:13,361 - root - INFO - epoch: 2:
2022-07-13 00:03:13,362 - root - INFO - epoch mean loss: 0.2906410430859499
2022-07-13 00:03:13,362 - root - INFO - train acc: 0.9430203908241291, val acc: 0.9581697986045037
2022-07-13 00:03:13,363 - root - INFO - train auc: 0.9839670666949873, val auc: 0.9912259591559626
2022-07-13 00:03:13,363 - root - INFO - train ap: 0.9858572532543342, val ap: 0.9919205606641989
2022-07-13 00:03:13,363 - root - INFO - train time: 307.3138177394867, val time: 115.88281536102295
2022-07-13 00:03:18,352 - root - INFO - start 3 epoch
2022-07-13 00:08:13,889 - root - INFO - train_time [294.57536578178406, 264.43358302116394, 307.3138177394867, 295.585346698761]
2022-07-13 00:08:13,891 - root - INFO - Mean 29047.702831029892
2022-07-13 00:08:13,892 - root - INFO - Standard deviation 15.847947876610517
2022-07-13 00:08:13,893 - root - INFO - 95% 1553.0988919078306
2022-07-13 00:08:13,893 - root - INFO - --------
2022-07-13 00:09:39,760 - root - INFO - epoch: 3:
2022-07-13 00:09:39,761 - root - INFO - epoch mean loss: 0.2931801287841903
2022-07-13 00:09:39,762 - root - INFO - train acc: 0.9420440385160012, val acc: 0.9487095623215985
2022-07-13 00:09:39,762 - root - INFO - train auc: 0.9841448385726423, val auc: 0.9905411574789883
2022-07-13 00:09:39,762 - root - INFO - train ap: 0.9859598332133113, val ap: 0.9913241283688489
2022-07-13 00:09:39,762 - root - INFO - train time: 295.585346698761, val time: 85.8672525882721
2022-07-13 00:09:43,965 - root - INFO - start 4 epoch
2022-07-13 00:13:05,526 - root - INFO - train_time [294.57536578178406, 264.43358302116394, 307.3138177394867, 295.585346698761, 201.62227773666382]
2022-07-13 00:13:05,526 - root - INFO - Mean 27270.607819557186
2022-07-13 00:13:05,527 - root - INFO - Standard deviation 38.264247456866
2022-07-13 00:13:05,527 - root - INFO - 95% 3354.0091701198926
2022-07-13 00:13:05,527 - root - INFO - --------
2022-07-13 00:14:25,561 - root - INFO - epoch: 4:
2022-07-13 00:14:25,562 - root - INFO - epoch mean loss: 0.3252391669291531
2022-07-13 00:14:25,562 - root - INFO - train acc: 0.9326263806287169, val acc: 0.9454686013320647
2022-07-13 00:14:25,563 - root - INFO - train auc: 0.981775914519022, val auc: 0.988226118973993
2022-07-13 00:14:25,563 - root - INFO - train ap: 0.9838677409062498, val ap: 0.9890755582606384
2022-07-13 00:14:25,563 - root - INFO - train time: 201.62227773666382, val time: 80.0340564250946
2022-07-13 00:14:30,210 - root - INFO - start 5 epoch
2022-07-13 00:18:28,424 - root - INFO - train_time [294.57536578178406, 264.43358302116394, 307.3138177394867, 295.585346698761, 201.62227773666382, 238.35027074813843]
2022-07-13 00:18:28,424 - root - INFO - Mean 26698.011028766632
2022-07-13 00:18:28,424 - root - INFO - Standard deviation 37.202966776124
2022-07-13 00:18:28,424 - root - INFO - 95% 2976.8573269611575
2022-07-13 00:18:28,424 - root - INFO - --------
2022-07-13 00:19:53,896 - root - INFO - epoch: 5:
2022-07-13 00:19:53,898 - root - INFO - epoch mean loss: 0.2829115306096074
2022-07-13 00:19:53,900 - root - INFO - train acc: 0.9445843953554234, val acc: 0.9570151443070092
2022-07-13 00:19:53,901 - root - INFO - train auc: 0.9851703377230246, val auc: 0.9907483634138122
2022-07-13 00:19:53,903 - root - INFO - train ap: 0.9868457738712688, val ap: 0.9913165705560071
2022-07-13 00:19:53,903 - root - INFO - train time: 238.35027074813843, val time: 85.4712462425232
2022-07-13 00:19:53,903 - root - INFO - No improvment over 3 epochs, stop training
2022-07-13 00:19:53,904 - root - INFO - Loading the best model at epoch 2
2022-07-13 00:19:57,145 - root - INFO - Loaded the best model at epoch 2 for inference
2022-07-13 00:21:15,802 - root - INFO - Test statistics: t all nodes -- acc: 0.9572282350142721, auc: 0.9911802747383445, ap: 0.9918839470232852, time: 78.65517950057983
2022-07-13 00:21:15,802 - root - INFO - Saving NAT model ...
2022-07-13 00:21:20,879 - root - INFO - NAT model saved
2022-07-13 00:21:20,879 - root - INFO - transductive_auc [0.9888447943922455, 0.9911802747383445]
2022-07-13 00:21:20,880 - root - INFO - Mean 99.0012534565295
2022-07-13 00:21:20,880 - root - INFO - Standard deviation 0.0011677401730494918
2022-07-13 00:21:20,880 - root - INFO - 95% 0.16184053102534063
2022-07-13 00:21:20,880 - root - INFO - --------
2022-07-13 00:21:20,880 - root - INFO - transductive_ap [0.990130735218305, 0.9918839470232852]
2022-07-13 00:21:20,880 - root - INFO - Mean 99.10073411207951
2022-07-13 00:21:20,880 - root - INFO - Standard deviation 0.0008766059024901129
2022-07-13 00:21:20,881 - root - INFO - 95% 0.12149137970346681
2022-07-13 00:21:20,881 - root - INFO - --------
2022-07-13 00:21:20,881 - root - INFO - test_times [98.14612698554993, 78.65517950057983]
2022-07-13 00:21:20,881 - root - INFO - Mean 8840.065324306488
2022-07-13 00:21:20,881 - root - INFO - Standard deviation 9.745473742485046
2022-07-13 00:21:20,881 - root - INFO - 95% 1350.6537515605771
2022-07-13 00:21:20,881 - root - INFO - --------
2022-07-13 00:21:20,881 - root - INFO - early_stoppers [1, 3]
2022-07-13 00:21:20,881 - root - INFO - Mean 200
2022-07-13 00:21:20,881 - root - INFO - Standard deviation 1.0
2022-07-13 00:21:20,882 - root - INFO - 95% 138.5929291125633
2022-07-13 00:21:20,882 - root - INFO - --------
2022-07-13 00:21:20,882 - root - INFO - total_time [1508.503723859787, 2302.5405230522156]
2022-07-13 00:21:20,882 - root - INFO - Mean 190552.21234560013
2022-07-13 00:21:20,882 - root - INFO - Standard deviation 397.0183995962143
2022-07-13 00:21:20,882 - root - INFO - 95% 55023.94291162146
2022-07-13 00:21:20,882 - root - INFO - --------
