2022-07-12 23:18:00,157 - root - INFO - Create log file at log/1657693080.1575332-reddit-t-2-32k16-16.log
2022-07-12 23:18:00,157 - root - INFO - Command line executed: python main.py -d reddit --pos_dim 16 --bs 100 --n_degree 32 16 --n_hop 2 --mode t --bias 1e-5 --seed 2 --verbosity 1 --drop_out 0.1 --attn_n_head 2 --ngh_dim 4 --self_dim 172 --run 2 --replace_prob 0.7
2022-07-12 23:18:00,157 - root - INFO - Full args parsed:
2022-07-12 23:18:00,157 - root - INFO - Namespace(attn_n_head=2, bias=1e-05, bs=100, cpu_cores=1, data='reddit', drop_out=0.1, gpu=0, linear_out=False, lr=0.0001, mode='t', n_degree=['32', '16'], n_epoch=50, n_hop=2, ngh_dim=4, pos_dim=16, replace_prob=0.7, run=2, seed=2, self_dim=172, t_batch=False, t_batch_order=False, time_dim=1, tolerance=0.001, verbosity=1)
2022-07-12 23:18:00,158 - root - INFO - Create checkpoint directory ./saved_checkpoints/1657693080.1575332-reddit-t-2-32k16-16/
2022-07-12 23:18:00,158 - root - INFO - Create best model directory ./best_models/1657693080.1575332-reddit-t-2-32k16-16/
2022-07-12 23:18:01,603 - root - INFO - Transductive training...
2022-07-12 23:18:06,163 - root - INFO - num of training instances: 470713
2022-07-12 23:18:06,163 - root - INFO - num of batches per epoch: 4708
2022-07-12 23:18:06,213 - root - INFO - start 0 epoch
2022-07-12 23:22:17,007 - root - INFO - train_time [250.84296703338623]
2022-07-12 23:22:17,009 - root - INFO - Mean 25084.296703338623
2022-07-12 23:22:17,010 - root - INFO - Standard deviation 0.0
2022-07-12 23:22:17,010 - root - INFO - 95% 0.0
2022-07-12 23:22:17,010 - root - INFO - --------
2022-07-12 23:23:37,620 - root - INFO - epoch: 0:
2022-07-12 23:23:37,620 - root - INFO - epoch mean loss: 0.343428562216448
2022-07-12 23:23:37,621 - root - INFO - train acc: 0.9332986406117247, val acc: 0.9524411274976213
2022-07-12 23:23:37,621 - root - INFO - train auc: 0.9780298959218351, val auc: 0.9886859055363939
2022-07-12 23:23:37,622 - root - INFO - train ap: 0.9804627215698906, val ap: 0.9900693220542018
2022-07-12 23:23:37,622 - root - INFO - train time: 250.84296703338623, val time: 80.60911774635315
2022-07-12 23:23:40,204 - root - INFO - start 1 epoch
2022-07-12 23:27:18,296 - root - INFO - train_time [250.84296703338623, 218.1331398487091]
2022-07-12 23:27:18,296 - root - INFO - Mean 23448.805344104767
2022-07-12 23:27:18,296 - root - INFO - Standard deviation 16.354913592338562
2022-07-12 23:27:18,296 - root - INFO - 95% 2266.6753801450764
2022-07-12 23:27:18,296 - root - INFO - --------
2022-07-12 23:28:43,722 - root - INFO - epoch: 1:
2022-07-12 23:28:43,727 - root - INFO - epoch mean loss: 0.31132930900407807
2022-07-12 23:28:43,729 - root - INFO - train acc: 0.9388052251486831, val acc: 0.9495371471614336
2022-07-12 23:28:43,732 - root - INFO - train auc: 0.9819538763806287, val auc: 0.9864588288931176
2022-07-12 23:28:43,735 - root - INFO - train ap: 0.9842684260090737, val ap: 0.9873469664298772
2022-07-12 23:28:43,736 - root - INFO - train time: 218.1331398487091, val time: 85.4257800579071
2022-07-12 23:28:48,615 - root - INFO - start 2 epoch
2022-07-12 23:33:23,663 - root - INFO - train_time [250.84296703338623, 218.1331398487091, 275.21614050865173]
2022-07-12 23:33:23,664 - root - INFO - Mean 24806.408246358238
2022-07-12 23:33:23,665 - root - INFO - Standard deviation 23.386732573191626
2022-07-12 23:33:23,665 - root - INFO - 95% 2646.457923933203
2022-07-12 23:33:23,665 - root - INFO - --------
2022-07-12 23:35:08,643 - root - INFO - epoch: 2:
2022-07-12 23:35:08,645 - root - INFO - epoch mean loss: 0.3459195701346852
2022-07-12 23:35:08,645 - root - INFO - train acc: 0.926342395921835, val acc: 0.9368755946717412
2022-07-12 23:35:08,646 - root - INFO - train auc: 0.9794484919286323, val auc: 0.9854407632611798
2022-07-12 23:35:08,646 - root - INFO - train ap: 0.981741465967221, val ap: 0.986728093323207
2022-07-12 23:35:08,646 - root - INFO - train time: 275.21614050865173, val time: 104.97834587097168
2022-07-12 23:35:12,941 - root - INFO - start 3 epoch
2022-07-12 23:39:34,182 - root - INFO - train_time [250.84296703338623, 218.1331398487091, 275.21614050865173, 261.2789137363434]
2022-07-12 23:39:34,183 - root - INFO - Mean 25136.77902817726
2022-07-12 23:39:34,183 - root - INFO - Standard deviation 21.04632750342446
2022-07-12 23:39:34,184 - root - INFO - 95% 2062.540095335597
2022-07-12 23:39:34,184 - root - INFO - --------
2022-07-12 23:41:18,270 - root - INFO - epoch: 3:
2022-07-12 23:41:18,273 - root - INFO - epoch mean loss: 0.34281335395864493
2022-07-12 23:41:18,275 - root - INFO - train acc: 0.9281467714528463, val acc: 0.9409689184903267
2022-07-12 23:41:18,276 - root - INFO - train auc: 0.9797994689889549, val auc: 0.9865568568129559
2022-07-12 23:41:18,277 - root - INFO - train ap: 0.9820764864654047, val ap: 0.9878815889650419
2022-07-12 23:41:18,278 - root - INFO - train time: 261.2789137363434, val time: 104.08623099327087
2022-07-12 23:41:18,278 - root - INFO - No improvment over 3 epochs, stop training
2022-07-12 23:41:18,278 - root - INFO - Loading the best model at epoch 0
2022-07-12 23:41:20,324 - root - INFO - Loaded the best model at epoch 0 for inference
2022-07-12 23:42:57,385 - root - INFO - Test statistics: t all nodes -- acc: 0.9533579130986363, auc: 0.9884079274698699, ap: 0.989581557152597, time: 97.05881547927856
2022-07-12 23:42:57,393 - root - INFO - Saving NAT model ...
2022-07-12 23:43:01,897 - root - INFO - NAT model saved
2022-07-12 23:43:01,912 - root - INFO - transductive_auc [0.9884079274698699]
2022-07-12 23:43:01,913 - root - INFO - Mean 98.84079274698699
2022-07-12 23:43:01,914 - root - INFO - Standard deviation 0.0
2022-07-12 23:43:01,915 - root - INFO - 95% 0.0
2022-07-12 23:43:01,915 - root - INFO - --------
2022-07-12 23:43:01,915 - root - INFO - transductive_ap [0.989581557152597]
2022-07-12 23:43:01,916 - root - INFO - Mean 98.9581557152597
2022-07-12 23:43:01,916 - root - INFO - Standard deviation 0.0
2022-07-12 23:43:01,917 - root - INFO - 95% 0.0
2022-07-12 23:43:01,917 - root - INFO - --------
2022-07-12 23:43:01,917 - root - INFO - test_times [97.05881547927856]
2022-07-12 23:43:01,917 - root - INFO - Mean 9705.881547927856
2022-07-12 23:43:01,918 - root - INFO - Standard deviation 0.0
2022-07-12 23:43:01,918 - root - INFO - 95% 0.0
2022-07-12 23:43:01,918 - root - INFO - --------
2022-07-12 23:43:01,919 - root - INFO - early_stoppers [1]
2022-07-12 23:43:01,919 - root - INFO - Mean 100
2022-07-12 23:43:01,919 - root - INFO - Standard deviation 0.0
2022-07-12 23:43:01,920 - root - INFO - 95% 0.0
2022-07-12 23:43:01,920 - root - INFO - --------
2022-07-12 23:43:01,920 - root - INFO - total_time [1499.9777867794037]
2022-07-12 23:43:01,920 - root - INFO - Mean 149997.77867794037
2022-07-12 23:43:01,921 - root - INFO - Standard deviation 0.0
2022-07-12 23:43:01,921 - root - INFO - 95% 0.0
2022-07-12 23:43:01,921 - root - INFO - --------
2022-07-12 23:43:01,922 - root - INFO - Transductive training...
2022-07-12 23:43:04,345 - root - INFO - num of training instances: 470713
2022-07-12 23:43:04,345 - root - INFO - num of batches per epoch: 4708
2022-07-12 23:43:04,395 - root - INFO - start 0 epoch
2022-07-12 23:47:57,894 - root - INFO - train_time [293.5484850406647]
2022-07-12 23:47:57,895 - root - INFO - Mean 29354.848504066467
2022-07-12 23:47:57,895 - root - INFO - Standard deviation 0.0
2022-07-12 23:47:57,895 - root - INFO - 95% 0.0
2022-07-12 23:47:57,895 - root - INFO - --------
2022-07-12 23:49:48,228 - root - INFO - epoch: 0:
2022-07-12 23:49:48,230 - root - INFO - epoch mean loss: 0.3476110227412355
2022-07-12 23:49:48,232 - root - INFO - train acc: 0.9317257858963468, val acc: 0.9523965271170314
2022-07-12 23:49:48,233 - root - INFO - train auc: 0.9776684154630416, val auc: 0.9886657734201554
2022-07-12 23:49:48,235 - root - INFO - train ap: 0.9798990242921763, val ap: 0.9898935314493417
2022-07-12 23:49:48,235 - root - INFO - train time: 293.5484850406647, val time: 110.3327112197876
2022-07-12 23:49:54,318 - root - INFO - start 1 epoch
2022-07-12 23:54:18,728 - root - INFO - train_time [293.5484850406647, 264.5284504890442]
2022-07-12 23:54:18,729 - root - INFO - Mean 27903.846776485443
2022-07-12 23:54:18,730 - root - INFO - Standard deviation 14.510017275810242
2022-07-12 23:54:18,730 - root - INFO - 95% 2010.9857957284378
2022-07-12 23:54:18,730 - root - INFO - --------
2022-07-12 23:56:08,203 - root - INFO - epoch: 1:
2022-07-12 23:56:08,206 - root - INFO - epoch mean loss: 0.3807464923769767
2022-07-12 23:56:08,207 - root - INFO - train acc: 0.919398541489663, val acc: 0.9296899777989217
2022-07-12 23:56:08,208 - root - INFO - train auc: 0.9750498406966864, val auc: 0.983843357268871
2022-07-12 23:56:08,209 - root - INFO - train ap: 0.9781703559349904, val ap: 0.9853134213268456
2022-07-12 23:56:08,210 - root - INFO - train time: 264.5284504890442, val time: 109.47348856925964
2022-07-12 23:56:13,451 - root - INFO - start 2 epoch
2022-07-13 00:01:18,160 - root - INFO - train_time [293.5484850406647, 264.5284504890442, 304.75698685646057]
2022-07-13 00:01:18,161 - root - INFO - Mean 28761.130746205647
2022-07-13 00:01:18,162 - root - INFO - Standard deviation 16.95132920581906
2022-07-13 00:01:18,163 - root - INFO - 95% 1918.2234780999136
2022-07-13 00:01:18,163 - root - INFO - --------
2022-07-13 00:03:14,362 - root - INFO - epoch: 2:
2022-07-13 00:03:14,363 - root - INFO - epoch mean loss: 0.3059625305993421
2022-07-13 00:03:14,363 - root - INFO - train acc: 0.9396644010195413, val acc: 0.9566236520773866
2022-07-13 00:03:14,363 - root - INFO - train auc: 0.9823507327952422, val auc: 0.9904652748870124
2022-07-13 00:03:14,364 - root - INFO - train ap: 0.9845920784067665, val ap: 0.9913052435483067
2022-07-13 00:03:14,364 - root - INFO - train time: 304.75698685646057, val time: 116.19892954826355
2022-07-13 00:03:19,853 - root - INFO - start 3 epoch
2022-07-13 00:08:15,819 - root - INFO - train_time [293.5484850406647, 264.5284504890442, 304.75698685646057, 296.0140461921692]
2022-07-13 00:08:15,820 - root - INFO - Mean 28971.199214458466
2022-07-13 00:08:15,820 - root - INFO - Standard deviation 15.124460313983645
2022-07-13 00:08:15,820 - root - INFO - 95% 1482.1971107703973
2022-07-13 00:08:15,820 - root - INFO - --------
2022-07-13 00:09:40,925 - root - INFO - epoch: 3:
2022-07-13 00:09:40,926 - root - INFO - epoch mean loss: 0.2944077184904895
2022-07-13 00:09:40,927 - root - INFO - train acc: 0.9429152506372133, val acc: 0.9589131382810022
2022-07-13 00:09:40,927 - root - INFO - train auc: 0.9838464103653355, val auc: 0.9911985485053917
2022-07-13 00:09:40,927 - root - INFO - train ap: 0.9857847997765311, val ap: 0.9917724818383553
2022-07-13 00:09:40,927 - root - INFO - train time: 296.0140461921692, val time: 85.10526323318481
2022-07-13 00:09:45,201 - root - INFO - start 4 epoch
2022-07-13 00:13:05,633 - root - INFO - train_time [293.5484850406647, 264.5284504890442, 304.75698685646057, 296.0140461921692, 200.46805047988892]
2022-07-13 00:13:05,634 - root - INFO - Mean 27186.32038116455
2022-07-13 00:13:05,634 - root - INFO - Standard deviation 38.174813943851404
2022-07-13 00:13:05,635 - root - INFO - 95% 3346.169977068856
2022-07-13 00:13:05,636 - root - INFO - --------
2022-07-13 00:14:23,665 - root - INFO - epoch: 4:
2022-07-13 00:14:23,667 - root - INFO - epoch mean loss: 0.3325464955610979
2022-07-13 00:14:23,668 - root - INFO - train acc: 0.9306407533276693, val acc: 0.9456816920393276
2022-07-13 00:14:23,670 - root - INFO - train auc: 0.9809614179174927, val auc: 0.9881095075622424
2022-07-13 00:14:23,671 - root - INFO - train ap: 0.9830928110991122, val ap: 0.9890732138215871
2022-07-13 00:14:23,671 - root - INFO - train time: 200.46805047988892, val time: 78.02922534942627
2022-07-13 00:14:28,053 - root - INFO - start 5 epoch
2022-07-13 00:18:23,746 - root - INFO - train_time [293.5484850406647, 264.5284504890442, 304.75698685646057, 296.0140461921692, 200.46805047988892, 235.73362374305725]
2022-07-13 00:18:23,747 - root - INFO - Mean 26584.160713354748
2022-07-13 00:18:23,748 - root - INFO - Standard deviation 37.359449707869096
2022-07-13 00:18:23,748 - root - INFO - 95% 2989.3785692780125
2022-07-13 00:18:23,749 - root - INFO - --------
2022-07-13 00:19:49,191 - root - INFO - epoch: 5:
2022-07-13 00:19:49,191 - root - INFO - epoch mean loss: 0.2800673055387369
2022-07-13 00:19:49,192 - root - INFO - train acc: 0.9453671056357973, val acc: 0.9588586267047257
2022-07-13 00:19:49,192 - root - INFO - train auc: 0.9854756159728123, val auc: 0.9915610814601173
2022-07-13 00:19:49,192 - root - INFO - train ap: 0.987054562966816, val ap: 0.992094289857977
2022-07-13 00:19:49,192 - root - INFO - train time: 235.73362374305725, val time: 85.44161224365234
2022-07-13 00:19:49,193 - root - INFO - No improvment over 3 epochs, stop training
2022-07-13 00:19:49,193 - root - INFO - Loading the best model at epoch 2
2022-07-13 00:19:51,453 - root - INFO - Loaded the best model at epoch 2 for inference
2022-07-13 00:21:09,376 - root - INFO - Test statistics: t all nodes -- acc: 0.9557068664763717, auc: 0.9903988389034253, ap: 0.9911553165219879, time: 77.92043733596802
2022-07-13 00:21:09,376 - root - INFO - Saving NAT model ...
2022-07-13 00:21:15,152 - root - INFO - NAT model saved
2022-07-13 00:21:15,155 - root - INFO - transductive_auc [0.9884079274698699, 0.9903988389034253]
2022-07-13 00:21:15,155 - root - INFO - Mean 98.94033831866476
2022-07-13 00:21:15,156 - root - INFO - Standard deviation 0.0009954557167776712
2022-07-13 00:21:15,157 - root - INFO - 95% 0.13796312359006369
2022-07-13 00:21:15,157 - root - INFO - --------
2022-07-13 00:21:15,157 - root - INFO - transductive_ap [0.989581557152597, 0.9911553165219879]
2022-07-13 00:21:15,158 - root - INFO - Mean 99.03684368372924
2022-07-13 00:21:15,158 - root - INFO - Standard deviation 0.0007868796846954296
2022-07-13 00:21:15,159 - root - INFO - 95% 0.10905596036110983
2022-07-13 00:21:15,159 - root - INFO - --------
2022-07-13 00:21:15,159 - root - INFO - test_times [97.05881547927856, 77.92043733596802]
2022-07-13 00:21:15,160 - root - INFO - Mean 8748.96264076233
2022-07-13 00:21:15,160 - root - INFO - Standard deviation 9.569189071655273
2022-07-13 00:21:15,161 - root - INFO - 95% 1326.2219426726347
2022-07-13 00:21:15,161 - root - INFO - --------
2022-07-13 00:21:15,161 - root - INFO - early_stoppers [1, 3]
2022-07-13 00:21:15,161 - root - INFO - Mean 200
2022-07-13 00:21:15,162 - root - INFO - Standard deviation 1.0
2022-07-13 00:21:15,162 - root - INFO - 95% 138.5929291125633
2022-07-13 00:21:15,162 - root - INFO - --------
2022-07-13 00:21:15,163 - root - INFO - total_time [1499.9777867794037, 2292.759906768799]
2022-07-13 00:21:15,163 - root - INFO - Mean 189636.88467741013
2022-07-13 00:21:15,164 - root - INFO - Standard deviation 396.39105999469757
2022-07-13 00:21:15,164 - root - INFO - 95% 54936.99807869895
2022-07-13 00:21:15,164 - root - INFO - --------
